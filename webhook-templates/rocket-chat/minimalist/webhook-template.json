{
    "id": "microsoft-teams",
    "description": "Microsoft Teams",
    "status": "USER_DEFINED",
    "format": "jsonTemplate",
    "rank": 100,
    "href": "/app/rest/webhooks/templates/id:microsoft-teams",
    "preferredDateFormat": "",
    "toolTip": "Post to Microsoft Teams Group Chat Software",
    "templateItem": [
        {
            "id": "0",
            "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0",
            "templateText": {
                "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/templateContent",
                "content": "{\n    \"@type\": \"MessageCard\",\n    \"@context\": \"http://schema.org/extensions\",\n    \"summary\": \"TeamCity - ${buildName} - ${buildResult}\",\n    \"themeColor\": \"#FF0000\",\n    \"sections\": [\n        {\n            \"startGroup\": true,\n            \"title\": \"<a href=\\\"${rootUrl}/project.html?projectId=${projectId}\\\">${projectName}</a> :: <a href=\\\"${rootUrl}/viewType.html?buildTypeId=${buildTypeId}\\\">${buildName}</a> # <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildNumber}</strong></a> has <strong>${buildStateDescription}</strong> with a status of <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildResult}</strong></a>\",\n            \"activityImage\": \"https://raw.githubusercontent.com/tcplugins/tcWebHooks/master/docs/icons/buildFailed%402x.png\",\n            \"activityTitle\": \"${buildName} - **${buildResult}**\",\n            \"activitySubtitle\": \"Triggered by **${triggeredBy}** on agent **${agentName}**\"\n        }\n    ]\n}",
                "useTemplateTextForBranch": false
            },
            "branchTemplateText": {
                "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/branchTemplateContent",
                "content": "{\n    \"@type\": \"MessageCard\",\n    \"@context\": \"http://schema.org/extensions\",\n    \"summary\": \"TeamCity - ${buildName}-${sanitize(branchName)} - ${buildResult}\",\n    \"themeColor\": \"#FF0000\",\n    \"sections\": [\n        {\n            \"startGroup\": true,\n            \"title\": \"<a href=\\\"${rootUrl}/project.html?projectId=${projectId}\\\">${projectName}</a> :: <a href=\\\"${rootUrl}/viewType.html?buildTypeId=${buildTypeId}\\\">${buildName}</a> # <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildNumber}</strong></a> has <strong>${buildStateDescription}</strong> with a status of <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildResult}</strong></a>\",\n            \"activityImage\": \"https://raw.githubusercontent.com/tcplugins/tcWebHooks/master/docs/icons/buildFailed%402x.png\",\n            \"activityTitle\": \"${buildName} (${sanitize(branchDisplayName)}) - **${buildResult}**\",\n            \"activitySubtitle\": \"Triggered by **${triggeredBy}** on agent **${agentName}**\"\n        }\n    ]\n}"
            },
            "buildState": [
                {
                    "type": "buildStarted",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/buildStarted"
                },
                {
                    "type": "changesLoaded",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/changesLoaded"
                },
                {
                    "type": "buildInterrupted",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/buildInterrupted"
                },
                {
                    "type": "beforeBuildFinish",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/beforeBuildFinish"
                },
                {
                    "type": "buildSuccessful",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/buildSuccessful"
                },
                {
                    "type": "buildFailed",
                    "enabled": true,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/buildFailed"
                },
                {
                    "type": "buildFixed",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/buildFixed"
                },
                {
                    "type": "buildBroken",
                    "enabled": true,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/buildBroken"
                },
                {
                    "type": "responsibilityChanged",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:0/buildStates/responsibilityChanged"
                }
            ]
        },
        {
            "id": "1",
            "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1",
            "templateText": {
                "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/templateContent",
                "content": "{\n    \"@type\": \"MessageCard\",\n    \"@context\": \"http://schema.org/extensions\",\n    \"summary\": \"TeamCity - ${buildName} - ${buildResult}\",\n    \"themeColor\": \"#00FF00\",\n    \"sections\": [\n        {\n            \"startGroup\": true,\n            \"title\": \"<a href=\\\"${rootUrl}/project.html?projectId=${projectId}\\\">${projectName}</a> :: <a href=\\\"${rootUrl}/viewType.html?buildTypeId=${buildTypeId}\\\">${buildName}</a> # <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildNumber}</strong></a> has <strong>${buildStateDescription}</strong> with a status of <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildResult}</strong></a>\",\n            \"activityImage\": \"https://raw.githubusercontent.com/tcplugins/tcWebHooks/master/docs/icons/buildSuccessful%402x.png\",\n            \"activityTitle\": \"${buildName} - **${buildResult}**\",\n            \"activitySubtitle\": \"Triggered by **${triggeredBy}** on agent **${agentName}**\"\n        }\n    ]\n}",
                "useTemplateTextForBranch": false
            },
            "branchTemplateText": {
                "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/branchTemplateContent",
                "content": "{\n    \"@type\": \"MessageCard\",\n    \"@context\": \"http://schema.org/extensions\",\n    \"summary\": \"TeamCity - ${buildName}-${sanitize(branchName)} - ${buildResult}\",\n    \"themeColor\": \"#00FF00\",\n    \"sections\": [\n        {\n            \"startGroup\": true,\n            \"title\": \"<a href=\\\"${rootUrl}/project.html?projectId=${projectId}\\\">${projectName}</a> :: <a href=\\\"${rootUrl}/viewType.html?buildTypeId=${buildTypeId}\\\">${buildName}</a> # <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildNumber}</strong></a> has <strong>${buildStateDescription}</strong> with a status of <a href=\\\"${rootUrl}/viewLog.html?buildTypeId=${buildTypeId}&buildId=${buildId}\\\"><strong>${buildResult}</strong></a>\",\n            \"activityImage\": \"https://raw.githubusercontent.com/tcplugins/tcWebHooks/master/docs/icons/buildSuccessful%402x.png\",\n            \"activityTitle\": \"${buildName} (${sanitize(branchDisplayName)}) - **${buildResult}**\",\n            \"activitySubtitle\": \"Triggered by **${triggeredBy}** on agent **${agentName}**\"\n        }\n    ]\n}"
            },
            "buildState": [
                {
                    "type": "buildStarted",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/buildStarted"
                },
                {
                    "type": "changesLoaded",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/changesLoaded"
                },
                {
                    "type": "buildInterrupted",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/buildInterrupted"
                },
                {
                    "type": "beforeBuildFinish",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/beforeBuildFinish"
                },
                {
                    "type": "buildSuccessful",
                    "enabled": true,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/buildSuccessful"
                },
                {
                    "type": "buildFailed",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/buildFailed"
                },
                {
                    "type": "buildFixed",
                    "enabled": true,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/buildFixed"
                },
                {
                    "type": "buildBroken",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/buildBroken"
                },
                {
                    "type": "responsibilityChanged",
                    "enabled": false,
                    "href": "/app/rest/webhooks/templates/id:microsoft-teams/templateItems/id:1/buildStates/responsibilityChanged"
                }
            ]
        }
    ]
}